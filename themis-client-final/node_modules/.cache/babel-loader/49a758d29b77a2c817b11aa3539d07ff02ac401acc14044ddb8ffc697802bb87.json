{"ast":null,"code":"import{useState,useEffect}from'react';import{useAuth as useAuthContext}from'../context/AuthContext';export const useAuth=()=>{// Use the existing AuthContext hook\nconst auth=useAuthContext();const[authState,setAuthState]=useState({user:null,isAuthenticated:false});useEffect(()=>{// Load user from local storage on initial load\nconst token=localStorage.getItem('authToken');if(token){try{// Mock the decoding of the token\nconst user=JSON.parse(localStorage.getItem('user')||'null');if(user){setAuthState({user,isAuthenticated:true});}}catch(error){console.error('Error loading user from storage:',error);}}},[]);// Determine if user can view all projects based on role\nconst canViewAllProjects=auth.isAdmin||auth.isExecutive||auth.isMainPMO;return{...auth,canViewAllProjects,setUser:user=>{if(user){// Save user and token to local storage\nlocalStorage.setItem('authToken','mock-token');localStorage.setItem('user',JSON.stringify(user));setAuthState({user,isAuthenticated:true});}else{// Remove user and token from local storage\nlocalStorage.removeItem('authToken');localStorage.removeItem('user');setAuthState({user:null,isAuthenticated:false});}}};};","map":{"version":3,"names":["useState","useEffect","useAuth","useAuthContext","auth","authState","setAuthState","user","isAuthenticated","token","localStorage","getItem","JSON","parse","error","console","canViewAllProjects","isAdmin","isExecutive","isMainPMO","setUser","setItem","stringify","removeItem"],"sources":["/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/hooks/useAuth.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { User, UserRole } from '../types';\nimport { useAuth as useAuthContext } from '../context/AuthContext';\n\ninterface AuthState {\n  user: User | null;\n  isAuthenticated: boolean;\n}\n\nexport const useAuth = () => {\n  // Use the existing AuthContext hook\n  const auth = useAuthContext();\n  \n  const [authState, setAuthState] = useState<AuthState>({\n    user: null,\n    isAuthenticated: false,\n  });\n\n  useEffect(() => {\n    // Load user from local storage on initial load\n    const token = localStorage.getItem('authToken');\n    if (token) {\n      try {\n        // Mock the decoding of the token\n        const user = JSON.parse(localStorage.getItem('user') || 'null');\n        if (user) {\n          setAuthState({\n            user,\n            isAuthenticated: true,\n          });\n        }\n      } catch (error) {\n        console.error('Error loading user from storage:', error);\n      }\n    }\n  }, []);\n  \n  // Determine if user can view all projects based on role\n  const canViewAllProjects = auth.isAdmin || auth.isExecutive || auth.isMainPMO;\n  \n  return {\n    ...auth,\n    canViewAllProjects,\n    setUser: (user: User | null) => {\n      if (user) {\n        // Save user and token to local storage\n        localStorage.setItem('authToken', 'mock-token');\n        localStorage.setItem('user', JSON.stringify(user));\n        setAuthState({\n          user,\n          isAuthenticated: true,\n        });\n      } else {\n        // Remove user and token from local storage\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('user');\n        setAuthState({\n          user: null,\n          isAuthenticated: false,\n        });\n      }\n    },\n  };\n}; "],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAE3C,OAASC,OAAO,GAAI,CAAAC,cAAc,KAAQ,wBAAwB,CAOlE,MAAO,MAAM,CAAAD,OAAO,CAAGA,CAAA,GAAM,CAC3B;AACA,KAAM,CAAAE,IAAI,CAAGD,cAAc,CAAC,CAAC,CAE7B,KAAM,CAACE,SAAS,CAAEC,YAAY,CAAC,CAAGN,QAAQ,CAAY,CACpDO,IAAI,CAAE,IAAI,CACVC,eAAe,CAAE,KACnB,CAAC,CAAC,CAEFP,SAAS,CAAC,IAAM,CACd;AACA,KAAM,CAAAQ,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAC/C,GAAIF,KAAK,CAAE,CACT,GAAI,CACF;AACA,KAAM,CAAAF,IAAI,CAAGK,IAAI,CAACC,KAAK,CAACH,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,EAAI,MAAM,CAAC,CAC/D,GAAIJ,IAAI,CAAE,CACRD,YAAY,CAAC,CACXC,IAAI,CACJC,eAAe,CAAE,IACnB,CAAC,CAAC,CACJ,CACF,CAAE,MAAOM,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CAC1D,CACF,CACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAE,kBAAkB,CAAGZ,IAAI,CAACa,OAAO,EAAIb,IAAI,CAACc,WAAW,EAAId,IAAI,CAACe,SAAS,CAE7E,MAAO,CACL,GAAGf,IAAI,CACPY,kBAAkB,CAClBI,OAAO,CAAGb,IAAiB,EAAK,CAC9B,GAAIA,IAAI,CAAE,CACR;AACAG,YAAY,CAACW,OAAO,CAAC,WAAW,CAAE,YAAY,CAAC,CAC/CX,YAAY,CAACW,OAAO,CAAC,MAAM,CAAET,IAAI,CAACU,SAAS,CAACf,IAAI,CAAC,CAAC,CAClDD,YAAY,CAAC,CACXC,IAAI,CACJC,eAAe,CAAE,IACnB,CAAC,CAAC,CACJ,CAAC,IAAM,CACL;AACAE,YAAY,CAACa,UAAU,CAAC,WAAW,CAAC,CACpCb,YAAY,CAACa,UAAU,CAAC,MAAM,CAAC,CAC/BjB,YAAY,CAAC,CACXC,IAAI,CAAE,IAAI,CACVC,eAAe,CAAE,KACnB,CAAC,CAAC,CACJ,CACF,CACF,CAAC,CACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}