{"ast":null,"code":"var _jsxFileName = \"/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/components/shared/WorkflowForm.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { Box, Button, Typography, Paper, Stepper, Step, StepLabel, Alert, Chip } from '@mui/material';\nimport { useAuth } from '../../context/AuthContext';\nimport { ApprovalStatus } from '../../context/AuthContext';\nimport { usePermission, Permission } from './PermissionGuard';\nimport FormWithValidation from './FormWithValidation';\nimport { UserRole } from '../../types';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WorkflowForm = ({\n  defaultValues,\n  validationSchema,\n  onSubmit,\n  children,\n  title,\n  subtitle,\n  currentStatus = ApprovalStatus.DRAFT,\n  isOwnItem = true,\n  objectOwner\n}) => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Check permissions\n  const canApprove = usePermission(Permission.APPROVE_PROJECT, isOwnItem);\n  const canEdit = usePermission(Permission.EDIT_PROJECT, isOwnItem);\n  const canRequest = usePermission(Permission.REQUEST_CHANGES);\n\n  // Determine active step based on current status\n  const getActiveStep = () => {\n    switch (currentStatus) {\n      case ApprovalStatus.DRAFT:\n        return 0;\n      case ApprovalStatus.SUBMITTED:\n      case ApprovalStatus.SUB_PMO_REVIEW:\n        return 1;\n      case ApprovalStatus.SUB_PMO_APPROVED:\n      case ApprovalStatus.MAIN_PMO_REVIEW:\n        return 2;\n      case ApprovalStatus.APPROVED:\n        return 3;\n      case ApprovalStatus.REJECTED:\n        return -1;\n      case ApprovalStatus.CHANGES_REQUESTED:\n        return -1;\n      default:\n        return 0;\n    }\n  };\n\n  // Handle workflow action\n  const handleWorkflowAction = async (data, action) => {\n    setIsSubmitting(true);\n    setError(null);\n    try {\n      await onSubmit(data, action);\n    } catch (err) {\n      console.error('Error processing workflow action:', err);\n      setError('An error occurred while processing your request. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Render status badge\n  const renderStatusBadge = () => {\n    let color = 'default';\n    switch (currentStatus) {\n      case ApprovalStatus.DRAFT:\n        color = 'default';\n        break;\n      case ApprovalStatus.SUBMITTED:\n      case ApprovalStatus.SUB_PMO_REVIEW:\n      case ApprovalStatus.MAIN_PMO_REVIEW:\n        color = 'info';\n        break;\n      case ApprovalStatus.SUB_PMO_APPROVED:\n        color = 'secondary';\n        break;\n      case ApprovalStatus.APPROVED:\n        color = 'success';\n        break;\n      case ApprovalStatus.REJECTED:\n        color = 'error';\n        break;\n      case ApprovalStatus.CHANGES_REQUESTED:\n        color = 'warning';\n        break;\n    }\n    return /*#__PURE__*/_jsxDEV(Chip, {\n      label: currentStatus.replace('_', ' '),\n      color: color,\n      size: \"small\",\n      sx: {\n        ml: 2\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Determine if form should be readonly\n  const isReadOnly = () => {\n    // If user is the owner, they can edit drafts or items with requested changes\n    if (isOwnItem && (currentStatus === ApprovalStatus.DRAFT || currentStatus === ApprovalStatus.CHANGES_REQUESTED)) {\n      return false;\n    }\n\n    // Admin and MainPMO can edit anything\n    if ((user === null || user === void 0 ? void 0 : user.role) === UserRole.ADMIN || (user === null || user === void 0 ? void 0 : user.role) === UserRole.MAIN_PMO) {\n      return false;\n    }\n\n    // SubPMO can edit in certain stages\n    if ((user === null || user === void 0 ? void 0 : user.role) === UserRole.SUB_PMO && (currentStatus === ApprovalStatus.SUBMITTED || currentStatus === ApprovalStatus.SUB_PMO_REVIEW)) {\n      return false;\n    }\n\n    // By default, form is readonly in other cases\n    return true;\n  };\n\n  // Determine which action buttons to show\n  const getActionButtons = () => {\n    const buttons = [];\n\n    // Draft actions\n    if (currentStatus === ApprovalStatus.DRAFT && isOwnItem) {\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'SAVE_DRAFT')),\n        disabled: isSubmitting,\n        children: \"Save Draft\"\n      }, \"save-draft\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this));\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'SUBMIT')),\n        disabled: isSubmitting,\n        children: \"Submit for Approval\"\n      }, \"submit\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this));\n    }\n\n    // Submitted actions (for reviewers)\n    if ((currentStatus === ApprovalStatus.SUBMITTED || currentStatus === ApprovalStatus.SUB_PMO_REVIEW) && ((user === null || user === void 0 ? void 0 : user.role) === UserRole.SUB_PMO || (user === null || user === void 0 ? void 0 : user.role) === UserRole.MAIN_PMO || (user === null || user === void 0 ? void 0 : user.role) === UserRole.ADMIN)) {\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        color: \"warning\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'REQUEST_CHANGES')),\n        disabled: isSubmitting,\n        children: \"Request Changes\"\n      }, \"request-changes\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this));\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        color: \"error\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'REJECT')),\n        disabled: isSubmitting,\n        children: \"Reject\"\n      }, \"reject\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }, this));\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"success\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'APPROVE')),\n        disabled: isSubmitting,\n        children: \"Approve\"\n      }, \"approve\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this));\n    }\n\n    // SubPMO Approved actions (for Main PMO)\n    if (currentStatus === ApprovalStatus.SUB_PMO_APPROVED && ((user === null || user === void 0 ? void 0 : user.role) === UserRole.MAIN_PMO || (user === null || user === void 0 ? void 0 : user.role) === UserRole.ADMIN)) {\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        color: \"warning\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'REQUEST_CHANGES')),\n        disabled: isSubmitting,\n        children: \"Request Changes\"\n      }, \"request-changes\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this));\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        color: \"error\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'REJECT')),\n        disabled: isSubmitting,\n        children: \"Reject\"\n      }, \"reject\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this));\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"success\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'APPROVE')),\n        disabled: isSubmitting,\n        children: \"Final Approval\"\n      }, \"approve\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this));\n    }\n\n    // Changes requested actions (for item owner)\n    if (currentStatus === ApprovalStatus.CHANGES_REQUESTED && isOwnItem) {\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'SAVE_DRAFT')),\n        disabled: isSubmitting,\n        children: \"Save Changes\"\n      }, \"save-changes\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 9\n      }, this));\n      buttons.push(/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        onClick: handleSubmit(data => handleWorkflowAction(data, 'SUBMIT')),\n        disabled: isSubmitting,\n        children: \"Resubmit\"\n      }, \"resubmit\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 9\n      }, this));\n    }\n    return buttons;\n  };\n\n  // Get form methods from useForm\n  const {\n    handleSubmit,\n    control,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues,\n    ...(validationSchema && {\n      resolver: validationSchema\n    })\n  });\n\n  // Display a read-only message if needed\n  const readOnlyMessage = isReadOnly() ? /*#__PURE__*/_jsxDEV(Alert, {\n    severity: \"info\",\n    sx: {\n      mb: 3\n    },\n    children: [\"This form is in read-only mode because it's currently under review.\", isOwnItem ? ' You will be notified when action is required.' : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 297,\n    columnNumber: 5\n  }, this) : null;\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    sx: {\n      p: 3\n    },\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        alignItems: 'center',\n        mb: 2\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        component: \"div\",\n        fontWeight: \"bold\",\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this), renderStatusBadge()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this), subtitle && /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"body2\",\n      color: \"text.secondary\",\n      sx: {\n        mb: 3\n      },\n      children: subtitle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Stepper, {\n      activeStep: getActiveStep(),\n      sx: {\n        mb: 4\n      },\n      children: [/*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"Draft\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"Department Review\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"PMO Review\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"Approved\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 7\n    }, this), readOnlyMessage, /*#__PURE__*/_jsxDEV(FormWithValidation, {\n      defaultValues: defaultValues,\n      validationSchema: validationSchema,\n      onSubmit: () => {} // Handled by our wrapper\n      ,\n      error: error || undefined,\n      isLoading: isSubmitting,\n      children: [children, /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          display: 'flex',\n          justifyContent: 'flex-end',\n          gap: 2,\n          mt: 3\n        },\n        children: getActionButtons()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 304,\n    columnNumber: 5\n  }, this);\n};\n_s(WorkflowForm, \"HEa4yD7raJLAcmx10CMOlyRtsjg=\", false, function () {\n  return [useAuth, usePermission, usePermission, usePermission, useForm];\n});\n_c = WorkflowForm;\nexport default WorkflowForm;\nvar _c;\n$RefreshReg$(_c, \"WorkflowForm\");","map":{"version":3,"names":["React","useState","useForm","Box","Button","Typography","Paper","Stepper","Step","StepLabel","Alert","Chip","useAuth","ApprovalStatus","usePermission","Permission","FormWithValidation","UserRole","jsxDEV","_jsxDEV","WorkflowForm","defaultValues","validationSchema","onSubmit","children","title","subtitle","currentStatus","DRAFT","isOwnItem","objectOwner","_s","user","isSubmitting","setIsSubmitting","error","setError","canApprove","APPROVE_PROJECT","canEdit","EDIT_PROJECT","canRequest","REQUEST_CHANGES","getActiveStep","SUBMITTED","SUB_PMO_REVIEW","SUB_PMO_APPROVED","MAIN_PMO_REVIEW","APPROVED","REJECTED","CHANGES_REQUESTED","handleWorkflowAction","data","action","err","console","renderStatusBadge","color","label","replace","size","sx","ml","fileName","_jsxFileName","lineNumber","columnNumber","isReadOnly","role","ADMIN","MAIN_PMO","SUB_PMO","getActionButtons","buttons","push","onClick","handleSubmit","disabled","variant","control","formState","errors","resolver","readOnlyMessage","severity","mb","p","display","alignItems","component","fontWeight","activeStep","undefined","isLoading","justifyContent","gap","mt","_c","$RefreshReg$"],"sources":["/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/components/shared/WorkflowForm.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useForm, FieldValues, DefaultValues, SubmitHandler } from 'react-hook-form';\nimport { \n  Box, \n  Button, \n  Typography, \n  Paper, \n  Stepper, \n  Step, \n  StepLabel, \n  Divider,\n  Alert,\n  Chip\n} from '@mui/material';\nimport { useAuth } from '../../context/AuthContext';\nimport { ApprovalStatus, getNextApprovalStatus } from '../../context/AuthContext';\nimport { usePermission, Permission } from './PermissionGuard';\nimport FormWithValidation from './FormWithValidation';\nimport { UserRole } from '../../types';\n\ninterface WorkflowFormProps<T extends FieldValues> {\n  defaultValues: DefaultValues<T>;\n  validationSchema?: any;\n  onSubmit: (data: T, action: WorkflowAction) => Promise<void>;\n  children: React.ReactNode;\n  title: string;\n  subtitle?: string;\n  currentStatus?: ApprovalStatus;\n  isOwnItem?: boolean;\n  objectOwner?: string;\n}\n\nexport type WorkflowAction = 'SAVE_DRAFT' | 'SUBMIT' | 'APPROVE' | 'REJECT' | 'REQUEST_CHANGES';\n\nconst WorkflowForm = <T extends FieldValues>({ \n  defaultValues,\n  validationSchema,\n  onSubmit,\n  children,\n  title,\n  subtitle,\n  currentStatus = ApprovalStatus.DRAFT,\n  isOwnItem = true,\n  objectOwner\n}: WorkflowFormProps<T>) => {\n  const { user } = useAuth();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Check permissions\n  const canApprove = usePermission(Permission.APPROVE_PROJECT, isOwnItem);\n  const canEdit = usePermission(Permission.EDIT_PROJECT, isOwnItem);\n  const canRequest = usePermission(Permission.REQUEST_CHANGES);\n  \n  // Determine active step based on current status\n  const getActiveStep = () => {\n    switch (currentStatus) {\n      case ApprovalStatus.DRAFT:\n        return 0;\n      case ApprovalStatus.SUBMITTED:\n      case ApprovalStatus.SUB_PMO_REVIEW:\n        return 1;\n      case ApprovalStatus.SUB_PMO_APPROVED:\n      case ApprovalStatus.MAIN_PMO_REVIEW:\n        return 2;\n      case ApprovalStatus.APPROVED:\n        return 3;\n      case ApprovalStatus.REJECTED:\n        return -1;\n      case ApprovalStatus.CHANGES_REQUESTED:\n        return -1;\n      default:\n        return 0;\n    }\n  };\n  \n  // Handle workflow action\n  const handleWorkflowAction = async (data: T, action: WorkflowAction) => {\n    setIsSubmitting(true);\n    setError(null);\n    \n    try {\n      await onSubmit(data, action);\n    } catch (err) {\n      console.error('Error processing workflow action:', err);\n      setError('An error occurred while processing your request. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n  \n  // Render status badge\n  const renderStatusBadge = () => {\n    let color = 'default';\n    \n    switch (currentStatus) {\n      case ApprovalStatus.DRAFT:\n        color = 'default';\n        break;\n      case ApprovalStatus.SUBMITTED:\n      case ApprovalStatus.SUB_PMO_REVIEW:\n      case ApprovalStatus.MAIN_PMO_REVIEW:\n        color = 'info';\n        break;\n      case ApprovalStatus.SUB_PMO_APPROVED:\n        color = 'secondary';\n        break;\n      case ApprovalStatus.APPROVED:\n        color = 'success';\n        break;\n      case ApprovalStatus.REJECTED:\n        color = 'error';\n        break;\n      case ApprovalStatus.CHANGES_REQUESTED:\n        color = 'warning';\n        break;\n    }\n    \n    return (\n      <Chip \n        label={currentStatus.replace('_', ' ')} \n        color={color as any} \n        size=\"small\" \n        sx={{ ml: 2 }}\n      />\n    );\n  };\n  \n  // Determine if form should be readonly\n  const isReadOnly = () => {\n    // If user is the owner, they can edit drafts or items with requested changes\n    if (isOwnItem && (currentStatus === ApprovalStatus.DRAFT || currentStatus === ApprovalStatus.CHANGES_REQUESTED)) {\n      return false;\n    }\n    \n    // Admin and MainPMO can edit anything\n    if (user?.role === UserRole.ADMIN || user?.role === UserRole.MAIN_PMO) {\n      return false;\n    }\n    \n    // SubPMO can edit in certain stages\n    if (user?.role === UserRole.SUB_PMO && \n        (currentStatus === ApprovalStatus.SUBMITTED || \n         currentStatus === ApprovalStatus.SUB_PMO_REVIEW)) {\n      return false;\n    }\n    \n    // By default, form is readonly in other cases\n    return true;\n  };\n  \n  // Determine which action buttons to show\n  const getActionButtons = () => {\n    const buttons = [];\n    \n    // Draft actions\n    if (currentStatus === ApprovalStatus.DRAFT && isOwnItem) {\n      buttons.push(\n        <Button\n          key=\"save-draft\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SAVE_DRAFT'))}\n          disabled={isSubmitting}\n        >\n          Save Draft\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"submit\"\n          variant=\"contained\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SUBMIT'))}\n          disabled={isSubmitting}\n        >\n          Submit for Approval\n        </Button>\n      );\n    }\n    \n    // Submitted actions (for reviewers)\n    if ((currentStatus === ApprovalStatus.SUBMITTED || currentStatus === ApprovalStatus.SUB_PMO_REVIEW) && \n        (user?.role === UserRole.SUB_PMO || user?.role === UserRole.MAIN_PMO || user?.role === UserRole.ADMIN)) {\n      \n      buttons.push(\n        <Button\n          key=\"request-changes\"\n          color=\"warning\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REQUEST_CHANGES'))}\n          disabled={isSubmitting}\n        >\n          Request Changes\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"reject\"\n          color=\"error\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REJECT'))}\n          disabled={isSubmitting}\n        >\n          Reject\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"approve\"\n          variant=\"contained\"\n          color=\"success\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'APPROVE'))}\n          disabled={isSubmitting}\n        >\n          Approve\n        </Button>\n      );\n    }\n    \n    // SubPMO Approved actions (for Main PMO)\n    if (currentStatus === ApprovalStatus.SUB_PMO_APPROVED && \n        (user?.role === UserRole.MAIN_PMO || user?.role === UserRole.ADMIN)) {\n      \n      buttons.push(\n        <Button\n          key=\"request-changes\"\n          color=\"warning\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REQUEST_CHANGES'))}\n          disabled={isSubmitting}\n        >\n          Request Changes\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"reject\"\n          color=\"error\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REJECT'))}\n          disabled={isSubmitting}\n        >\n          Reject\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"approve\"\n          variant=\"contained\"\n          color=\"success\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'APPROVE'))}\n          disabled={isSubmitting}\n        >\n          Final Approval\n        </Button>\n      );\n    }\n    \n    // Changes requested actions (for item owner)\n    if (currentStatus === ApprovalStatus.CHANGES_REQUESTED && isOwnItem) {\n      buttons.push(\n        <Button\n          key=\"save-changes\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SAVE_DRAFT'))}\n          disabled={isSubmitting}\n        >\n          Save Changes\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"resubmit\"\n          variant=\"contained\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SUBMIT'))}\n          disabled={isSubmitting}\n        >\n          Resubmit\n        </Button>\n      );\n    }\n    \n    return buttons;\n  };\n  \n  // Get form methods from useForm\n  const {\n    handleSubmit,\n    control,\n    formState: { errors }\n  } = useForm<T>({\n    defaultValues,\n    ...(validationSchema && { resolver: validationSchema }),\n  });\n\n  // Display a read-only message if needed\n  const readOnlyMessage = isReadOnly() ? (\n    <Alert severity=\"info\" sx={{ mb: 3 }}>\n      This form is in read-only mode because it's currently under review.\n      {isOwnItem ? ' You will be notified when action is required.' : null}\n    </Alert>\n  ) : null;\n  \n  return (\n    <Paper sx={{ p: 3 }}>\n      <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n        <Typography variant=\"h5\" component=\"div\" fontWeight=\"bold\">\n          {title}\n        </Typography>\n        {renderStatusBadge()}\n      </Box>\n      \n      {subtitle && (\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 3 }}>\n          {subtitle}\n        </Typography>\n      )}\n      \n      <Stepper activeStep={getActiveStep()} sx={{ mb: 4 }}>\n        <Step>\n          <StepLabel>Draft</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>Department Review</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>PMO Review</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>Approved</StepLabel>\n        </Step>\n      </Stepper>\n      \n      {readOnlyMessage}\n      \n      <FormWithValidation<T>\n        defaultValues={defaultValues}\n        validationSchema={validationSchema}\n        onSubmit={() => {}} // Handled by our wrapper\n        error={error || undefined}\n        isLoading={isSubmitting}\n      >\n        {children}\n        \n        <Box sx={{ display: 'flex', justifyContent: 'flex-end', gap: 2, mt: 3 }}>\n          {getActionButtons()}\n        </Box>\n      </FormWithValidation>\n    </Paper>\n  );\n};\n\nexport default WorkflowForm; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}