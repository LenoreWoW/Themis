{"ast":null,"code":"var _jsxFileName = \"/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/pages/LegacyProjectPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Box, CircularProgress, Alert } from '@mui/material';\nimport { useAuth } from '../context/AuthContext';\nimport { useTranslation } from 'react-i18next';\nimport api from '../services/api';\nimport { UserRole } from '../types';\nimport LegacyProjectForm from '../components/Project/LegacyProjectForm';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LegacyProjectPage = () => {\n  _s();\n  const {\n    token,\n    user\n  } = useAuth();\n  const {\n    t\n  } = useTranslation();\n  const navigate = useNavigate();\n  const [departments, setDepartments] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Check if user has appropriate role (SUB_PMO, MAIN_PMO, or ADMIN)\n  const hasPermission = (user === null || user === void 0 ? void 0 : user.role) === UserRole.SUB_PMO || (user === null || user === void 0 ? void 0 : user.role) === UserRole.MAIN_PMO || (user === null || user === void 0 ? void 0 : user.role) === UserRole.ADMIN;\n  useEffect(() => {\n    // Redirect if user doesn't have permission\n    if (!hasPermission) {\n      navigate('/dashboard');\n      return;\n    }\n    const fetchData = async () => {\n      setIsLoading(true);\n      setError(null);\n      try {\n        // Fetch departments\n        const departmentsResponse = await api.departments.getAllDepartments(token || '');\n        if (departmentsResponse.data) {\n          setDepartments(departmentsResponse.data);\n        }\n\n        // Fetch users\n        const usersResponse = await api.users.getAllUsers(token || '');\n        if (usersResponse.data) {\n          setUsers(usersResponse.data);\n        }\n      } catch (err) {\n        console.error('Error fetching data:', err);\n        setError('An error occurred while fetching required data. Please try again later.');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchData();\n  }, [hasPermission, navigate, token]);\n  const handleCancel = () => {\n    navigate('/projects');\n  };\n\n  // Show loading spinner while data is being fetched\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100vh'\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Show error message if data fetching failed\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        p: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Show permission error if user is not authorized\n  if (!hasPermission) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        p: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"error\",\n        children: \"You do not have permission to access this page.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(LegacyProjectForm, {\n    departments: departments,\n    users: users,\n    onCancel: handleCancel\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n};\n_s(LegacyProjectPage, \"IfMT67kp6lQ9Xfi1Ds5hEoWWBuY=\", false, function () {\n  return [useAuth, useTranslation, useNavigate];\n});\n_c = LegacyProjectPage;\nexport default LegacyProjectPage;\nvar _c;\n$RefreshReg$(_c, \"LegacyProjectPage\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","Box","CircularProgress","Alert","useAuth","useTranslation","api","UserRole","LegacyProjectForm","jsxDEV","_jsxDEV","LegacyProjectPage","_s","token","user","t","navigate","departments","setDepartments","users","setUsers","isLoading","setIsLoading","error","setError","hasPermission","role","SUB_PMO","MAIN_PMO","ADMIN","fetchData","departmentsResponse","getAllDepartments","data","usersResponse","getAllUsers","err","console","handleCancel","sx","display","justifyContent","alignItems","height","children","fileName","_jsxFileName","lineNumber","columnNumber","p","severity","onCancel","_c","$RefreshReg$"],"sources":["/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/pages/LegacyProjectPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Box, CircularProgress, Typography, Alert, Paper } from '@mui/material';\nimport { useAuth } from '../context/AuthContext';\nimport { useTranslation } from 'react-i18next';\nimport api from '../services/api';\nimport { Department, User, UserRole } from '../types';\nimport LegacyProjectForm from '../components/Project/LegacyProjectForm';\n\nconst LegacyProjectPage: React.FC = () => {\n  const { token, user } = useAuth();\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const [departments, setDepartments] = useState<Department[]>([]);\n  const [users, setUsers] = useState<User[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Check if user has appropriate role (SUB_PMO, MAIN_PMO, or ADMIN)\n  const hasPermission = user?.role === UserRole.SUB_PMO || \n                       user?.role === UserRole.MAIN_PMO || \n                       user?.role === UserRole.ADMIN;\n\n  useEffect(() => {\n    // Redirect if user doesn't have permission\n    if (!hasPermission) {\n      navigate('/dashboard');\n      return;\n    }\n\n    const fetchData = async () => {\n      setIsLoading(true);\n      setError(null);\n      \n      try {\n        // Fetch departments\n        const departmentsResponse = await api.departments.getAllDepartments(token || '');\n        if (departmentsResponse.data) {\n          setDepartments(departmentsResponse.data);\n        }\n        \n        // Fetch users\n        const usersResponse = await api.users.getAllUsers(token || '');\n        if (usersResponse.data) {\n          setUsers(usersResponse.data);\n        }\n      } catch (err) {\n        console.error('Error fetching data:', err);\n        setError('An error occurred while fetching required data. Please try again later.');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    \n    fetchData();\n  }, [hasPermission, navigate, token]);\n\n  const handleCancel = () => {\n    navigate('/projects');\n  };\n\n  // Show loading spinner while data is being fetched\n  if (isLoading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  // Show error message if data fetching failed\n  if (error) {\n    return (\n      <Box sx={{ p: 3 }}>\n        <Alert severity=\"error\">{error}</Alert>\n      </Box>\n    );\n  }\n\n  // Show permission error if user is not authorized\n  if (!hasPermission) {\n    return (\n      <Box sx={{ p: 3 }}>\n        <Alert severity=\"error\">\n          You do not have permission to access this page.\n        </Alert>\n      </Box>\n    );\n  }\n\n  return (\n    <LegacyProjectForm\n      departments={departments}\n      users={users}\n      onCancel={handleCancel}\n    />\n  );\n};\n\nexport default LegacyProjectPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}