{"ast":null,"code":"import React from'react';import{useAuth}from'../../context/AuthContext';import{canCreateProjects,canEditProjects,canApproveProjects,canRequestChanges}from'../../context/AuthContext';import{UserRole}from'../../types';import{Fragment as _Fragment,jsx as _jsx}from\"react/jsx-runtime\";export let Permission=/*#__PURE__*/function(Permission){Permission[\"CREATE_PROJECT\"]=\"CREATE_PROJECT\";Permission[\"EDIT_PROJECT\"]=\"EDIT_PROJECT\";Permission[\"APPROVE_PROJECT\"]=\"APPROVE_PROJECT\";Permission[\"VIEW_ALL_PROJECTS\"]=\"VIEW_ALL_PROJECTS\";Permission[\"VIEW_DEPARTMENT_PROJECTS\"]=\"VIEW_DEPARTMENT_PROJECTS\";Permission[\"REQUEST_CHANGES\"]=\"REQUEST_CHANGES\";Permission[\"CREATE_TASK\"]=\"CREATE_TASK\";Permission[\"EDIT_TASK\"]=\"EDIT_TASK\";Permission[\"APPROVE_TASK\"]=\"APPROVE_TASK\";Permission[\"SUBMIT_WEEKLY_UPDATE\"]=\"SUBMIT_WEEKLY_UPDATE\";Permission[\"APPROVE_WEEKLY_UPDATE\"]=\"APPROVE_WEEKLY_UPDATE\";return Permission;}({});const PermissionGuard=_ref=>{let{permission,isOwnItem=false,fallback=null,children}=_ref;const{user}=useAuth();// If no user, no permissions\nif(!user){return/*#__PURE__*/_jsx(_Fragment,{children:fallback});}const hasPermission=checkPermission(permission,user.role,isOwnItem);return hasPermission?/*#__PURE__*/_jsx(_Fragment,{children:children}):/*#__PURE__*/_jsx(_Fragment,{children:fallback});};export const usePermission=function(permission){let isOwnItem=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const{user}=useAuth();if(!user){return false;}return checkPermission(permission,user.role,isOwnItem);};const checkPermission=(permission,userRole,isOwnItem)=>{if(!userRole)return false;switch(permission){case Permission.CREATE_PROJECT:return canCreateProjects(userRole);case Permission.EDIT_PROJECT:return canEditProjects(userRole,isOwnItem);case Permission.APPROVE_PROJECT:return canApproveProjects(userRole,isOwnItem);case Permission.REQUEST_CHANGES:return canRequestChanges(userRole);case Permission.CREATE_TASK:return userRole===UserRole.ADMIN||userRole===UserRole.PROJECT_MANAGER||userRole===UserRole.TEAM_LEAD;case Permission.EDIT_TASK:return userRole===UserRole.ADMIN||userRole===UserRole.PROJECT_MANAGER||userRole===UserRole.TEAM_LEAD&&isOwnItem||userRole===UserRole.DEVELOPER&&isOwnItem;case Permission.APPROVE_TASK:return userRole===UserRole.ADMIN||userRole===UserRole.PROJECT_MANAGER||userRole===UserRole.TEAM_LEAD;case Permission.SUBMIT_WEEKLY_UPDATE:return userRole===UserRole.ADMIN||userRole===UserRole.PROJECT_MANAGER;case Permission.APPROVE_WEEKLY_UPDATE:return userRole===UserRole.ADMIN||userRole===UserRole.MAIN_PMO||userRole===UserRole.SUB_PMO;default:return false;}};export default PermissionGuard;","map":{"version":3,"names":["React","useAuth","canCreateProjects","canEditProjects","canApproveProjects","canRequestChanges","UserRole","Fragment","_Fragment","jsx","_jsx","Permission","PermissionGuard","_ref","permission","isOwnItem","fallback","children","user","hasPermission","checkPermission","role","usePermission","arguments","length","undefined","userRole","CREATE_PROJECT","EDIT_PROJECT","APPROVE_PROJECT","REQUEST_CHANGES","CREATE_TASK","ADMIN","PROJECT_MANAGER","TEAM_LEAD","EDIT_TASK","DEVELOPER","APPROVE_TASK","SUBMIT_WEEKLY_UPDATE","APPROVE_WEEKLY_UPDATE","MAIN_PMO","SUB_PMO"],"sources":["/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/components/shared/PermissionGuard.tsx"],"sourcesContent":["import React from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport { \n  canCreateProjects, \n  canEditProjects, \n  canApproveProjects, \n  canRequestChanges,\n} from '../../context/AuthContext';\nimport { UserRole } from '../../types';\n\nexport enum Permission {\n  CREATE_PROJECT = 'CREATE_PROJECT',\n  EDIT_PROJECT = 'EDIT_PROJECT',\n  APPROVE_PROJECT = 'APPROVE_PROJECT',\n  VIEW_ALL_PROJECTS = 'VIEW_ALL_PROJECTS',\n  VIEW_DEPARTMENT_PROJECTS = 'VIEW_DEPARTMENT_PROJECTS',\n  REQUEST_CHANGES = 'REQUEST_CHANGES',\n  CREATE_TASK = 'CREATE_TASK',\n  EDIT_TASK = 'EDIT_TASK',\n  APPROVE_TASK = 'APPROVE_TASK',\n  SUBMIT_WEEKLY_UPDATE = 'SUBMIT_WEEKLY_UPDATE',\n  APPROVE_WEEKLY_UPDATE = 'APPROVE_WEEKLY_UPDATE'\n}\n\ninterface PermissionGuardProps {\n  permission: Permission;\n  isOwnItem?: boolean;\n  fallback?: React.ReactNode;\n  children: React.ReactNode;\n}\n\nconst PermissionGuard: React.FC<PermissionGuardProps> = ({ \n  permission, \n  isOwnItem = false,\n  fallback = null, \n  children \n}) => {\n  const { user } = useAuth();\n  \n  // If no user, no permissions\n  if (!user) {\n    return <>{fallback}</>;\n  }\n  \n  const hasPermission = checkPermission(permission, user.role, isOwnItem);\n  \n  return hasPermission ? <>{children}</> : <>{fallback}</>;\n};\n\nexport const usePermission = (permission: Permission, isOwnItem = false): boolean => {\n  const { user } = useAuth();\n  \n  if (!user) {\n    return false;\n  }\n  \n  return checkPermission(permission, user.role, isOwnItem);\n};\n\nconst checkPermission = (permission: Permission, userRole: UserRole | string | undefined, isOwnItem: boolean): boolean => {\n  if (!userRole) return false;\n  \n  switch (permission) {\n    case Permission.CREATE_PROJECT:\n      return canCreateProjects(userRole);\n      \n    case Permission.EDIT_PROJECT:\n      return canEditProjects(userRole, isOwnItem);\n      \n    case Permission.APPROVE_PROJECT:\n      return canApproveProjects(userRole, isOwnItem);\n      \n    case Permission.REQUEST_CHANGES:\n      return canRequestChanges(userRole);\n      \n    case Permission.CREATE_TASK:\n      return userRole === UserRole.ADMIN || \n             userRole === UserRole.PROJECT_MANAGER || \n             userRole === UserRole.TEAM_LEAD;\n      \n    case Permission.EDIT_TASK:\n      return userRole === UserRole.ADMIN || \n             userRole === UserRole.PROJECT_MANAGER || \n             (userRole === UserRole.TEAM_LEAD && isOwnItem) || \n             (userRole === UserRole.DEVELOPER && isOwnItem);\n      \n    case Permission.APPROVE_TASK:\n      return userRole === UserRole.ADMIN || \n             userRole === UserRole.PROJECT_MANAGER || \n             userRole === UserRole.TEAM_LEAD;\n      \n    case Permission.SUBMIT_WEEKLY_UPDATE:\n      return userRole === UserRole.ADMIN || \n             userRole === UserRole.PROJECT_MANAGER;\n      \n    case Permission.APPROVE_WEEKLY_UPDATE:\n      return userRole === UserRole.ADMIN || \n             userRole === UserRole.MAIN_PMO || \n             userRole === UserRole.SUB_PMO;\n      \n    default:\n      return false;\n  }\n};\n\nexport default PermissionGuard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}