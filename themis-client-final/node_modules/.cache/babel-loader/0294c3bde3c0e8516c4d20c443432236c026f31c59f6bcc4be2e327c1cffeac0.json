{"ast":null,"code":"import React,{useState}from'react';import{useForm}from'react-hook-form';import{Box,Button,Typography,Paper,Stepper,Step,StepLabel,Alert,Chip}from'@mui/material';import{useAuth}from'../../context/AuthContext';import{ApprovalStatus}from'../../context/AuthContext';import{usePermission,Permission}from'./PermissionGuard';import FormWithValidation from'./FormWithValidation';import{UserRole}from'../../types';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const WorkflowForm=_ref=>{let{defaultValues,validationSchema,onSubmit,children,title,subtitle,currentStatus=ApprovalStatus.DRAFT,isOwnItem=true,objectOwner}=_ref;const{user}=useAuth();const[isSubmitting,setIsSubmitting]=useState(false);const[error,setError]=useState(null);// Check permissions\nconst canApprove=usePermission(Permission.APPROVE_PROJECT,isOwnItem);const canEdit=usePermission(Permission.EDIT_PROJECT,isOwnItem);const canRequest=usePermission(Permission.REQUEST_CHANGES);// Determine active step based on current status\nconst getActiveStep=()=>{switch(currentStatus){case ApprovalStatus.DRAFT:return 0;case ApprovalStatus.SUBMITTED:case ApprovalStatus.SUB_PMO_REVIEW:return 1;case ApprovalStatus.SUB_PMO_APPROVED:case ApprovalStatus.MAIN_PMO_REVIEW:return 2;case ApprovalStatus.APPROVED:return 3;case ApprovalStatus.REJECTED:return-1;case ApprovalStatus.CHANGES_REQUESTED:return-1;default:return 0;}};// Handle workflow action\nconst handleWorkflowAction=async(data,action)=>{setIsSubmitting(true);setError(null);try{await onSubmit(data,action);}catch(err){console.error('Error processing workflow action:',err);setError('An error occurred while processing your request. Please try again.');}finally{setIsSubmitting(false);}};// Render status badge\nconst renderStatusBadge=()=>{let color='default';switch(currentStatus){case ApprovalStatus.DRAFT:color='default';break;case ApprovalStatus.SUBMITTED:case ApprovalStatus.SUB_PMO_REVIEW:case ApprovalStatus.MAIN_PMO_REVIEW:color='info';break;case ApprovalStatus.SUB_PMO_APPROVED:color='secondary';break;case ApprovalStatus.APPROVED:color='success';break;case ApprovalStatus.REJECTED:color='error';break;case ApprovalStatus.CHANGES_REQUESTED:color='warning';break;}return/*#__PURE__*/_jsx(Chip,{label:currentStatus.replace('_',' '),color:color,size:\"small\",sx:{ml:2}});};// Determine if form should be readonly\nconst isReadOnly=()=>{// If user is the owner, they can edit drafts or items with requested changes\nif(isOwnItem&&(currentStatus===ApprovalStatus.DRAFT||currentStatus===ApprovalStatus.CHANGES_REQUESTED)){return false;}// Admin and MainPMO can edit anything\nif((user===null||user===void 0?void 0:user.role)===UserRole.ADMIN||(user===null||user===void 0?void 0:user.role)===UserRole.MAIN_PMO){return false;}// SubPMO can edit in certain stages\nif((user===null||user===void 0?void 0:user.role)===UserRole.SUB_PMO&&(currentStatus===ApprovalStatus.SUBMITTED||currentStatus===ApprovalStatus.SUB_PMO_REVIEW)){return false;}// By default, form is readonly in other cases\nreturn true;};// Determine which action buttons to show\nconst getActionButtons=()=>{const buttons=[];// Draft actions\nif(currentStatus===ApprovalStatus.DRAFT&&isOwnItem){buttons.push(/*#__PURE__*/_jsx(Button,{onClick:handleSubmit(data=>handleWorkflowAction(data,'SAVE_DRAFT')),disabled:isSubmitting,children:\"Save Draft\"},\"save-draft\"));buttons.push(/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSubmit(data=>handleWorkflowAction(data,'SUBMIT')),disabled:isSubmitting,children:\"Submit for Approval\"},\"submit\"));}// Submitted actions (for reviewers)\nif((currentStatus===ApprovalStatus.SUBMITTED||currentStatus===ApprovalStatus.SUB_PMO_REVIEW)&&((user===null||user===void 0?void 0:user.role)===UserRole.SUB_PMO||(user===null||user===void 0?void 0:user.role)===UserRole.MAIN_PMO||(user===null||user===void 0?void 0:user.role)===UserRole.ADMIN)){buttons.push(/*#__PURE__*/_jsx(Button,{color:\"warning\",onClick:handleSubmit(data=>handleWorkflowAction(data,'REQUEST_CHANGES')),disabled:isSubmitting,children:\"Request Changes\"},\"request-changes\"));buttons.push(/*#__PURE__*/_jsx(Button,{color:\"error\",onClick:handleSubmit(data=>handleWorkflowAction(data,'REJECT')),disabled:isSubmitting,children:\"Reject\"},\"reject\"));buttons.push(/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",onClick:handleSubmit(data=>handleWorkflowAction(data,'APPROVE')),disabled:isSubmitting,children:\"Approve\"},\"approve\"));}// SubPMO Approved actions (for Main PMO)\nif(currentStatus===ApprovalStatus.SUB_PMO_APPROVED&&((user===null||user===void 0?void 0:user.role)===UserRole.MAIN_PMO||(user===null||user===void 0?void 0:user.role)===UserRole.ADMIN)){buttons.push(/*#__PURE__*/_jsx(Button,{color:\"warning\",onClick:handleSubmit(data=>handleWorkflowAction(data,'REQUEST_CHANGES')),disabled:isSubmitting,children:\"Request Changes\"},\"request-changes\"));buttons.push(/*#__PURE__*/_jsx(Button,{color:\"error\",onClick:handleSubmit(data=>handleWorkflowAction(data,'REJECT')),disabled:isSubmitting,children:\"Reject\"},\"reject\"));buttons.push(/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",onClick:handleSubmit(data=>handleWorkflowAction(data,'APPROVE')),disabled:isSubmitting,children:\"Final Approval\"},\"approve\"));}// Changes requested actions (for item owner)\nif(currentStatus===ApprovalStatus.CHANGES_REQUESTED&&isOwnItem){buttons.push(/*#__PURE__*/_jsx(Button,{onClick:handleSubmit(data=>handleWorkflowAction(data,'SAVE_DRAFT')),disabled:isSubmitting,children:\"Save Changes\"},\"save-changes\"));buttons.push(/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSubmit(data=>handleWorkflowAction(data,'SUBMIT')),disabled:isSubmitting,children:\"Resubmit\"},\"resubmit\"));}return buttons;};// Get form methods from useForm\nconst{handleSubmit,control,formState:{errors}}=useForm({defaultValues,...(validationSchema&&{resolver:validationSchema})});// Display a read-only message if needed\nconst readOnlyMessage=isReadOnly()?/*#__PURE__*/_jsxs(Alert,{severity:\"info\",sx:{mb:3},children:[\"This form is in read-only mode because it's currently under review.\",isOwnItem?' You will be notified when action is required.':null]}):null;return/*#__PURE__*/_jsxs(Paper,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"div\",fontWeight:\"bold\",children:title}),renderStatusBadge()]}),subtitle&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mb:3},children:subtitle}),/*#__PURE__*/_jsxs(Stepper,{activeStep:getActiveStep(),sx:{mb:4},children:[/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:\"Draft\"})}),/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:\"Department Review\"})}),/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:\"PMO Review\"})}),/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:\"Approved\"})})]}),readOnlyMessage,/*#__PURE__*/_jsxs(FormWithValidation,{defaultValues:defaultValues,validationSchema:validationSchema,onSubmit:()=>{}// Handled by our wrapper\n,error:error||undefined,isLoading:isSubmitting,children:[children,/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'flex-end',gap:2,mt:3},children:getActionButtons()})]})]});};export default WorkflowForm;","map":{"version":3,"names":["React","useState","useForm","Box","Button","Typography","Paper","Stepper","Step","StepLabel","Alert","Chip","useAuth","ApprovalStatus","usePermission","Permission","FormWithValidation","UserRole","jsx","_jsx","jsxs","_jsxs","WorkflowForm","_ref","defaultValues","validationSchema","onSubmit","children","title","subtitle","currentStatus","DRAFT","isOwnItem","objectOwner","user","isSubmitting","setIsSubmitting","error","setError","canApprove","APPROVE_PROJECT","canEdit","EDIT_PROJECT","canRequest","REQUEST_CHANGES","getActiveStep","SUBMITTED","SUB_PMO_REVIEW","SUB_PMO_APPROVED","MAIN_PMO_REVIEW","APPROVED","REJECTED","CHANGES_REQUESTED","handleWorkflowAction","data","action","err","console","renderStatusBadge","color","label","replace","size","sx","ml","isReadOnly","role","ADMIN","MAIN_PMO","SUB_PMO","getActionButtons","buttons","push","onClick","handleSubmit","disabled","variant","control","formState","errors","resolver","readOnlyMessage","severity","mb","p","display","alignItems","component","fontWeight","activeStep","undefined","isLoading","justifyContent","gap","mt"],"sources":["/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/components/shared/WorkflowForm.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useForm, FieldValues, DefaultValues, SubmitHandler } from 'react-hook-form';\nimport { \n  Box, \n  Button, \n  Typography, \n  Paper, \n  Stepper, \n  Step, \n  StepLabel, \n  Divider,\n  Alert,\n  Chip\n} from '@mui/material';\nimport { useAuth } from '../../context/AuthContext';\nimport { ApprovalStatus, getNextApprovalStatus } from '../../context/AuthContext';\nimport { usePermission, Permission } from './PermissionGuard';\nimport FormWithValidation from './FormWithValidation';\nimport { UserRole } from '../../types';\n\ninterface WorkflowFormProps<T extends FieldValues> {\n  defaultValues: DefaultValues<T>;\n  validationSchema?: any;\n  onSubmit: (data: T, action: WorkflowAction) => Promise<void>;\n  children: React.ReactNode;\n  title: string;\n  subtitle?: string;\n  currentStatus?: ApprovalStatus;\n  isOwnItem?: boolean;\n  objectOwner?: string;\n}\n\nexport type WorkflowAction = 'SAVE_DRAFT' | 'SUBMIT' | 'APPROVE' | 'REJECT' | 'REQUEST_CHANGES';\n\nconst WorkflowForm = <T extends FieldValues>({ \n  defaultValues,\n  validationSchema,\n  onSubmit,\n  children,\n  title,\n  subtitle,\n  currentStatus = ApprovalStatus.DRAFT,\n  isOwnItem = true,\n  objectOwner\n}: WorkflowFormProps<T>) => {\n  const { user } = useAuth();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Check permissions\n  const canApprove = usePermission(Permission.APPROVE_PROJECT, isOwnItem);\n  const canEdit = usePermission(Permission.EDIT_PROJECT, isOwnItem);\n  const canRequest = usePermission(Permission.REQUEST_CHANGES);\n  \n  // Determine active step based on current status\n  const getActiveStep = () => {\n    switch (currentStatus) {\n      case ApprovalStatus.DRAFT:\n        return 0;\n      case ApprovalStatus.SUBMITTED:\n      case ApprovalStatus.SUB_PMO_REVIEW:\n        return 1;\n      case ApprovalStatus.SUB_PMO_APPROVED:\n      case ApprovalStatus.MAIN_PMO_REVIEW:\n        return 2;\n      case ApprovalStatus.APPROVED:\n        return 3;\n      case ApprovalStatus.REJECTED:\n        return -1;\n      case ApprovalStatus.CHANGES_REQUESTED:\n        return -1;\n      default:\n        return 0;\n    }\n  };\n  \n  // Handle workflow action\n  const handleWorkflowAction = async (data: T, action: WorkflowAction) => {\n    setIsSubmitting(true);\n    setError(null);\n    \n    try {\n      await onSubmit(data, action);\n    } catch (err) {\n      console.error('Error processing workflow action:', err);\n      setError('An error occurred while processing your request. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n  \n  // Render status badge\n  const renderStatusBadge = () => {\n    let color = 'default';\n    \n    switch (currentStatus) {\n      case ApprovalStatus.DRAFT:\n        color = 'default';\n        break;\n      case ApprovalStatus.SUBMITTED:\n      case ApprovalStatus.SUB_PMO_REVIEW:\n      case ApprovalStatus.MAIN_PMO_REVIEW:\n        color = 'info';\n        break;\n      case ApprovalStatus.SUB_PMO_APPROVED:\n        color = 'secondary';\n        break;\n      case ApprovalStatus.APPROVED:\n        color = 'success';\n        break;\n      case ApprovalStatus.REJECTED:\n        color = 'error';\n        break;\n      case ApprovalStatus.CHANGES_REQUESTED:\n        color = 'warning';\n        break;\n    }\n    \n    return (\n      <Chip \n        label={currentStatus.replace('_', ' ')} \n        color={color as any} \n        size=\"small\" \n        sx={{ ml: 2 }}\n      />\n    );\n  };\n  \n  // Determine if form should be readonly\n  const isReadOnly = () => {\n    // If user is the owner, they can edit drafts or items with requested changes\n    if (isOwnItem && (currentStatus === ApprovalStatus.DRAFT || currentStatus === ApprovalStatus.CHANGES_REQUESTED)) {\n      return false;\n    }\n    \n    // Admin and MainPMO can edit anything\n    if (user?.role === UserRole.ADMIN || user?.role === UserRole.MAIN_PMO) {\n      return false;\n    }\n    \n    // SubPMO can edit in certain stages\n    if (user?.role === UserRole.SUB_PMO && \n        (currentStatus === ApprovalStatus.SUBMITTED || \n         currentStatus === ApprovalStatus.SUB_PMO_REVIEW)) {\n      return false;\n    }\n    \n    // By default, form is readonly in other cases\n    return true;\n  };\n  \n  // Determine which action buttons to show\n  const getActionButtons = () => {\n    const buttons = [];\n    \n    // Draft actions\n    if (currentStatus === ApprovalStatus.DRAFT && isOwnItem) {\n      buttons.push(\n        <Button\n          key=\"save-draft\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SAVE_DRAFT'))}\n          disabled={isSubmitting}\n        >\n          Save Draft\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"submit\"\n          variant=\"contained\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SUBMIT'))}\n          disabled={isSubmitting}\n        >\n          Submit for Approval\n        </Button>\n      );\n    }\n    \n    // Submitted actions (for reviewers)\n    if ((currentStatus === ApprovalStatus.SUBMITTED || currentStatus === ApprovalStatus.SUB_PMO_REVIEW) && \n        (user?.role === UserRole.SUB_PMO || user?.role === UserRole.MAIN_PMO || user?.role === UserRole.ADMIN)) {\n      \n      buttons.push(\n        <Button\n          key=\"request-changes\"\n          color=\"warning\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REQUEST_CHANGES'))}\n          disabled={isSubmitting}\n        >\n          Request Changes\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"reject\"\n          color=\"error\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REJECT'))}\n          disabled={isSubmitting}\n        >\n          Reject\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"approve\"\n          variant=\"contained\"\n          color=\"success\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'APPROVE'))}\n          disabled={isSubmitting}\n        >\n          Approve\n        </Button>\n      );\n    }\n    \n    // SubPMO Approved actions (for Main PMO)\n    if (currentStatus === ApprovalStatus.SUB_PMO_APPROVED && \n        (user?.role === UserRole.MAIN_PMO || user?.role === UserRole.ADMIN)) {\n      \n      buttons.push(\n        <Button\n          key=\"request-changes\"\n          color=\"warning\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REQUEST_CHANGES'))}\n          disabled={isSubmitting}\n        >\n          Request Changes\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"reject\"\n          color=\"error\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'REJECT'))}\n          disabled={isSubmitting}\n        >\n          Reject\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"approve\"\n          variant=\"contained\"\n          color=\"success\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'APPROVE'))}\n          disabled={isSubmitting}\n        >\n          Final Approval\n        </Button>\n      );\n    }\n    \n    // Changes requested actions (for item owner)\n    if (currentStatus === ApprovalStatus.CHANGES_REQUESTED && isOwnItem) {\n      buttons.push(\n        <Button\n          key=\"save-changes\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SAVE_DRAFT'))}\n          disabled={isSubmitting}\n        >\n          Save Changes\n        </Button>\n      );\n      \n      buttons.push(\n        <Button\n          key=\"resubmit\"\n          variant=\"contained\"\n          onClick={handleSubmit((data) => handleWorkflowAction(data, 'SUBMIT'))}\n          disabled={isSubmitting}\n        >\n          Resubmit\n        </Button>\n      );\n    }\n    \n    return buttons;\n  };\n  \n  // Get form methods from useForm\n  const {\n    handleSubmit,\n    control,\n    formState: { errors }\n  } = useForm<T>({\n    defaultValues,\n    ...(validationSchema && { resolver: validationSchema }),\n  });\n\n  // Display a read-only message if needed\n  const readOnlyMessage = isReadOnly() ? (\n    <Alert severity=\"info\" sx={{ mb: 3 }}>\n      This form is in read-only mode because it's currently under review.\n      {isOwnItem ? ' You will be notified when action is required.' : null}\n    </Alert>\n  ) : null;\n  \n  return (\n    <Paper sx={{ p: 3 }}>\n      <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n        <Typography variant=\"h5\" component=\"div\" fontWeight=\"bold\">\n          {title}\n        </Typography>\n        {renderStatusBadge()}\n      </Box>\n      \n      {subtitle && (\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 3 }}>\n          {subtitle}\n        </Typography>\n      )}\n      \n      <Stepper activeStep={getActiveStep()} sx={{ mb: 4 }}>\n        <Step>\n          <StepLabel>Draft</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>Department Review</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>PMO Review</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>Approved</StepLabel>\n        </Step>\n      </Stepper>\n      \n      {readOnlyMessage}\n      \n      <FormWithValidation<T>\n        defaultValues={defaultValues}\n        validationSchema={validationSchema}\n        onSubmit={() => {}} // Handled by our wrapper\n        error={error || undefined}\n        isLoading={isSubmitting}\n      >\n        {children}\n        \n        <Box sx={{ display: 'flex', justifyContent: 'flex-end', gap: 2, mt: 3 }}>\n          {getActionButtons()}\n        </Box>\n      </FormWithValidation>\n    </Paper>\n  );\n};\n\nexport default WorkflowForm; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}