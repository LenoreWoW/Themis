{"ast":null,"code":"import React,{useState,useEffect}from'react';import*as yup from'yup';import{Dialog,DialogTitle,DialogContent,DialogActions,Button,TextField,MenuItem,FormControl,InputLabel,Select,Typography,Box,CircularProgress,Alert,useTheme,InputAdornment,List,ListItem,ListItemIcon,ListItemText}from'@mui/material';import{DatePicker as MuiDatePicker,LocalizationProvider}from'@mui/x-date-pickers';import{AdapterDateFns}from'@mui/x-date-pickers/AdapterDateFns';import{ChangeRequestType}from'../../types/change-request';import{useAuth}from'../../context/AuthContext';import InsertDriveFileIcon from'@mui/icons-material/InsertDriveFile';import AttachFileIcon from'@mui/icons-material/AttachFile';// Simple hook to fetch users\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useFetchAllUsers=()=>{const[users,setUsers]=useState([]);const{user:authUser}=useAuth();useEffect(()=>{const fetchUsers=async()=>{try{if(authUser){// In a real app, you would fetch from the API\n// For now, we'll use mock data\nconst mockUsers=[{id:'pm-1',firstName:'John',lastName:'Smith',role:'PROJECT_MANAGER'},{id:'pm-2',firstName:'Jane',lastName:'Doe',role:'PROJECT_MANAGER'},{id:'pm-3',firstName:'Robert',lastName:'Johnson',role:'PROJECT_MANAGER'}];setUsers(mockUsers);}}catch(error){console.error('Error fetching users:',error);}};fetchUsers();},[authUser]);return{users};};// Define validation schema\nconst validationSchema=yup.object().shape({title:yup.string().required('Title is required'),description:yup.string().required('Description is required'),type:yup.string().required('Change request type is required'),impact:yup.string().required('Impact assessment is required'),justification:yup.string().required('Justification is required'),alternatives:yup.string().required('Alternatives consideration is required'),newEndDate:yup.date().nullable().when('type',{is:ChangeRequestType.SCHEDULE,then:schema=>schema.required('New end date is required for timeline extension')}),newCost:yup.number().nullable().when('type',{is:ChangeRequestType.BUDGET,then:schema=>schema.required('New cost is required for budget change')}),newManager:yup.string().nullable().when('type',{is:ChangeRequestType.RESOURCE,then:schema=>schema.required('New project manager is required for delegation')}),newScope:yup.string().nullable().when('type',{is:ChangeRequestType.SCOPE,then:schema=>schema.required('New scope is required for scope change')})});const ChangeRequestDialog=_ref=>{let{open,onClose,projectId,onSubmitted,changeRequestType=null}=_ref;const{user}=useAuth();const{users}=useFetchAllUsers();const theme=useTheme();const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// Set initial type based on prop, or default to SCHEDULE\nconst initialType=changeRequestType||ChangeRequestType.SCHEDULE;const[formData,setFormData]=useState({title:'',description:'',type:initialType,newEndDate:null,newCost:'',newScopeDescription:'',newProjectManagerId:'',closureReason:'',attachments:[]});// Reset form when dialog opens/closes or type changes\nuseEffect(()=>{if(open){setFormData({title:getDefaultTitle(initialType),description:'',type:initialType,newEndDate:null,newCost:'',newScopeDescription:'',newProjectManagerId:'',closureReason:'',attachments:[]});setError(null);}},[open,initialType]);// Generate default title based on request type\nconst getDefaultTitle=type=>{switch(type){case ChangeRequestType.SCHEDULE:return'Request to Extend Project Timeline';case ChangeRequestType.BUDGET:return'Request to Modify Project Budget';case ChangeRequestType.SCOPE:return'Request to Change Project Scope';case ChangeRequestType.RESOURCE:return'Request to Change Project Manager';case ChangeRequestType.CLOSURE:return'Request to Close Project';default:return'Change Request';}};const handleChange=e=>{const{name,value}=e.target;setFormData({...formData,[name]:value});};const handleDateChange=date=>{setFormData({...formData,newEndDate:date});};const handleFileChange=event=>{if(event.target.files){setFormData({...formData,attachments:Array.from(event.target.files)});}};const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError(null);try{const validationErrors=await validateForm();if(validationErrors){setError(validationErrors);setLoading(false);return;}// Mock API call\nawait new Promise(resolve=>setTimeout(resolve,1000));// Create a new request in local data\nconst changeRequest={id:`cr-${Date.now()}`,projectId,title:formData.title,description:formData.description,type:formData.type,status:'PENDING',requestedById:(user===null||user===void 0?void 0:user.id)||'',requestedByName:`${user===null||user===void 0?void 0:user.firstName} ${user===null||user===void 0?void 0:user.lastName}`,requestedDate:new Date().toISOString(),// Add specific fields based on type\ndetails:{...(formData.type===ChangeRequestType.SCHEDULE&&{newEndDate:formData.newEndDate}),...(formData.type===ChangeRequestType.BUDGET&&{newCost:formData.newCost}),...(formData.type===ChangeRequestType.SCOPE&&{newScopeDescription:formData.newScopeDescription}),...(formData.type===ChangeRequestType.RESOURCE&&{newProjectManagerId:formData.newProjectManagerId})},attachments:formData.attachments.map(file=>({name:file.name,size:file.size}))};// Save to localStorage (mock)\nconst existingRequests=JSON.parse(localStorage.getItem('changeRequests')||'[]');localStorage.setItem('changeRequests',JSON.stringify([...existingRequests,changeRequest]));// Create audit log entry\nconst auditLogEntry={id:`audit-${Date.now()}`,projectId,action:'CHANGE_REQUEST_SUBMITTED',description:getAuditLogDescription(formData.type,formData.title),userId:(user===null||user===void 0?void 0:user.id)||'',userName:`${user===null||user===void 0?void 0:user.firstName} ${user===null||user===void 0?void 0:user.lastName}`,timestamp:new Date().toISOString()};const existingLogs=JSON.parse(localStorage.getItem('auditLogs')||'[]');localStorage.setItem('auditLogs',JSON.stringify([...existingLogs,auditLogEntry]));onSubmitted();onClose();}catch(err){setError('Failed to submit change request. Please try again.');console.error('Error submitting change request:',err);}finally{setLoading(false);}};const validateForm=async()=>{try{// Base validation schema\nlet validationSchema=yup.object().shape({title:yup.string().required('Title is required'),description:yup.string().required('Description is required'),type:yup.string().required('Change request type is required')});// Add additional validation based on type\nswitch(formData.type){case ChangeRequestType.SCHEDULE:validationSchema=validationSchema.shape({newEndDate:yup.date().nullable().required('New end date is required').min(new Date(),'End date cannot be in the past')});break;case ChangeRequestType.BUDGET:validationSchema=validationSchema.shape({newCost:yup.number().required('New cost is required').min(0,'Cost must be greater than or equal to 0')});break;case ChangeRequestType.SCOPE:validationSchema=validationSchema.shape({newScopeDescription:yup.string().required('New scope description is required')});break;case ChangeRequestType.RESOURCE:validationSchema=validationSchema.shape({newProjectManagerId:yup.string().required('New project manager is required')});break;case ChangeRequestType.CLOSURE:validationSchema=validationSchema.shape({newEndDate:yup.date().nullable().required('Closure date is required').min(new Date(),'Closure date cannot be in the past'),closureReason:yup.string().required('Reason for closure is required')});break;}await validationSchema.validate(formData,{abortEarly:false});return null;}catch(err){if(err instanceof yup.ValidationError){return err.errors.join(', ');}return'Validation failed';}};const renderAdditionalFields=()=>{switch(formData.type){case ChangeRequestType.SCHEDULE:return/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,children:/*#__PURE__*/_jsx(MuiDatePicker,{label:\"New End Date\",value:formData.newEndDate,onChange:handleDateChange,minDate:new Date(),slotProps:{textField:{fullWidth:true,margin:\"normal\",required:true,error:!!error&&error.includes('date')}}})});case ChangeRequestType.BUDGET:return/*#__PURE__*/_jsx(TextField,{name:\"newCost\",label:\"New Budget Cost\",type:\"number\",value:formData.newCost,onChange:handleChange,fullWidth:true,margin:\"normal\",required:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:\"$\"})},error:!!error&&error.includes('cost')});case ChangeRequestType.SCOPE:return/*#__PURE__*/_jsx(TextField,{name:\"newScopeDescription\",label:\"New Scope Description\",value:formData.newScopeDescription,onChange:handleChange,fullWidth:true,multiline:true,rows:4,margin:\"normal\",required:true,error:!!error&&error.includes('scope')});case ChangeRequestType.RESOURCE:return/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",required:true,error:!!error&&error.includes('manager'),children:[/*#__PURE__*/_jsx(InputLabel,{id:\"new-project-manager-label\",children:\"New Project Manager\"}),/*#__PURE__*/_jsx(Select,{labelId:\"new-project-manager-label\",id:\"newProjectManagerId\",name:\"newProjectManagerId\",value:formData.newProjectManagerId,onChange:handleChange,label:\"New Project Manager\",children:users.filter(user=>user.role==='PROJECT_MANAGER'||user.role==='MAIN_PMO').map(user=>/*#__PURE__*/_jsxs(MenuItem,{value:user.id,children:[user.firstName,\" \",user.lastName,\" (\",user.role,\")\"]},user.id))})]});case ChangeRequestType.CLOSURE:return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,children:/*#__PURE__*/_jsx(MuiDatePicker,{label:\"Requested Closure Date\",value:formData.newEndDate,onChange:handleDateChange,minDate:new Date(),slotProps:{textField:{fullWidth:true,margin:\"normal\",required:true,error:!!error&&error.includes('date')}}})}),/*#__PURE__*/_jsx(TextField,{name:\"closureReason\",label:\"Reason for Closure\",value:formData.closureReason||'',onChange:handleChange,fullWidth:true,multiline:true,rows:3,margin:\"normal\",required:true,error:!!error&&error.includes('reason')})]});default:return null;}};// Helper to get descriptive audit log message\nconst getAuditLogDescription=(type,title)=>{switch(type){case ChangeRequestType.SCHEDULE:return`Submitted a schedule extension request: ${title}`;case ChangeRequestType.BUDGET:return`Submitted a budget change request: ${title}`;case ChangeRequestType.SCOPE:return`Submitted a scope change request: ${title}`;case ChangeRequestType.RESOURCE:return`Submitted a project delegation request: ${title}`;case ChangeRequestType.CLOSURE:return`Submitted a project closure request: ${title}`;default:return`Submitted a change request: ${title}`;}};return/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:onClose,maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"Submit Change Request\",formData.type&&/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",color:\"textSecondary\",children:[\"Type: \",formData.type.replace('_',' ')]})]}),/*#__PURE__*/_jsxs(DialogContent,{children:[error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,id:\"change-request-form\",children:[/*#__PURE__*/_jsx(TextField,{name:\"title\",label:\"Title\",value:formData.title,onChange:handleChange,fullWidth:true,margin:\"normal\",required:true,error:!!error&&error.includes('Title')}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"change-request-type-label\",children:\"Change Request Type\"}),/*#__PURE__*/_jsxs(Select,{labelId:\"change-request-type-label\",id:\"type\",name:\"type\",value:formData.type,onChange:handleChange,label:\"Change Request Type\",children:[/*#__PURE__*/_jsx(MenuItem,{value:ChangeRequestType.SCHEDULE,children:\"Extend Project\"}),/*#__PURE__*/_jsx(MenuItem,{value:ChangeRequestType.BUDGET,children:\"Change Project Cost\"}),/*#__PURE__*/_jsx(MenuItem,{value:ChangeRequestType.SCOPE,children:\"Change Project Scope\"}),/*#__PURE__*/_jsx(MenuItem,{value:ChangeRequestType.RESOURCE,children:\"Delegate Project\"}),/*#__PURE__*/_jsx(MenuItem,{value:ChangeRequestType.CLOSURE,children:\"Close Project\"}),/*#__PURE__*/_jsx(MenuItem,{value:ChangeRequestType.OTHER,children:\"Other Change\"})]})]}),/*#__PURE__*/_jsx(TextField,{name:\"description\",label:\"Description\",value:formData.description,onChange:handleChange,fullWidth:true,multiline:true,rows:3,margin:\"normal\",required:true,error:!!error&&error.includes('Description')}),renderAdditionalFields(),/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsxs(Button,{variant:\"contained\",component:\"label\",startIcon:/*#__PURE__*/_jsx(AttachFileIcon,{}),sx:{mr:1},children:[\"Attach Files\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",hidden:true,multiple:true,onChange:handleFileChange})]}),formData.attachments.length>0&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[formData.attachments.length,\" file(s) selected\"]})]}),formData.attachments.length>0&&/*#__PURE__*/_jsx(List,{dense:true,sx:{mt:1},children:formData.attachments.map((file,index)=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(InsertDriveFileIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:file.name,secondary:`${(file.size/1024).toFixed(2)} KB`})]},index))})]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:onClose,disabled:loading,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",form:\"change-request-form\",variant:\"contained\",color:\"primary\",disabled:loading,startIcon:loading&&/*#__PURE__*/_jsx(CircularProgress,{size:20}),children:\"Submit Request\"})]})]});};export default ChangeRequestDialog;","map":{"version":3,"names":["React","useState","useEffect","yup","Dialog","DialogTitle","DialogContent","DialogActions","Button","TextField","MenuItem","FormControl","InputLabel","Select","Typography","Box","CircularProgress","Alert","useTheme","InputAdornment","List","ListItem","ListItemIcon","ListItemText","DatePicker","MuiDatePicker","LocalizationProvider","AdapterDateFns","ChangeRequestType","useAuth","InsertDriveFileIcon","AttachFileIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useFetchAllUsers","users","setUsers","user","authUser","fetchUsers","mockUsers","id","firstName","lastName","role","error","console","validationSchema","object","shape","title","string","required","description","type","impact","justification","alternatives","newEndDate","date","nullable","when","is","SCHEDULE","then","schema","newCost","number","BUDGET","newManager","RESOURCE","newScope","SCOPE","ChangeRequestDialog","_ref","open","onClose","projectId","onSubmitted","changeRequestType","theme","loading","setLoading","setError","initialType","formData","setFormData","newScopeDescription","newProjectManagerId","closureReason","attachments","getDefaultTitle","CLOSURE","handleChange","e","name","value","target","handleDateChange","handleFileChange","event","files","Array","from","handleSubmit","preventDefault","validationErrors","validateForm","Promise","resolve","setTimeout","changeRequest","Date","now","status","requestedById","requestedByName","requestedDate","toISOString","details","map","file","size","existingRequests","JSON","parse","localStorage","getItem","setItem","stringify","auditLogEntry","action","getAuditLogDescription","userId","userName","timestamp","existingLogs","err","min","validate","abortEarly","ValidationError","errors","join","renderAdditionalFields","dateAdapter","children","label","onChange","minDate","slotProps","textField","fullWidth","margin","includes","InputProps","startAdornment","position","multiline","rows","labelId","filter","maxWidth","variant","display","color","replace","severity","sx","mb","onSubmit","OTHER","mt","component","startIcon","mr","hidden","multiple","length","dense","index","primary","secondary","toFixed","onClick","disabled","form"],"sources":["/Users/hassanalsahli/Desktop/Themis/themis-client-final/src/components/Project/ChangeRequestDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  MenuItem,\n  FormControl,\n  InputLabel,\n  Select,\n  Typography,\n  Box,\n  CircularProgress,\n  Alert,\n  SelectChangeEvent,\n  FormHelperText,\n  IconButton,\n  Grid,\n  useTheme,\n  Autocomplete,\n  OutlinedInput,\n  InputAdornment,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText\n} from '@mui/material';\nimport { DatePicker as MuiDatePicker, LocalizationProvider } from '@mui/x-date-pickers';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport CloseIcon from '@mui/icons-material/Close';\nimport { Project, User } from '../../types';\nimport { ChangeRequestType, ChangeRequestStatus, ChangeRequest } from '../../types/change-request';\nimport { useAuth } from '../../context/AuthContext';\nimport WorkflowForm, { WorkflowAction } from '../shared/WorkflowForm';\nimport { ApprovalStatus } from '../../context/AuthContext';\nimport api from '../../services/api';\nimport InsertDriveFileIcon from '@mui/icons-material/InsertDriveFile';\nimport AttachFileIcon from '@mui/icons-material/AttachFile';\n\n// Simple hook to fetch users\nconst useFetchAllUsers = () => {\n  const [users, setUsers] = useState<User[]>([]);\n  const { user: authUser } = useAuth();\n\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        if (authUser) {\n          // In a real app, you would fetch from the API\n          // For now, we'll use mock data\n          const mockUsers = [\n            { id: 'pm-1', firstName: 'John', lastName: 'Smith', role: 'PROJECT_MANAGER' },\n            { id: 'pm-2', firstName: 'Jane', lastName: 'Doe', role: 'PROJECT_MANAGER' },\n            { id: 'pm-3', firstName: 'Robert', lastName: 'Johnson', role: 'PROJECT_MANAGER' }\n          ] as User[];\n          \n          setUsers(mockUsers);\n        }\n      } catch (error) {\n        console.error('Error fetching users:', error);\n      }\n    };\n\n    fetchUsers();\n  }, [authUser]);\n\n  return { users };\n};\n\n// Define validation schema\nconst validationSchema = yup.object().shape({\n  title: yup.string().required('Title is required'),\n  description: yup.string().required('Description is required'),\n  type: yup.string().required('Change request type is required'),\n  impact: yup.string().required('Impact assessment is required'),\n  justification: yup.string().required('Justification is required'),\n  alternatives: yup.string().required('Alternatives consideration is required'),\n  newEndDate: yup.date().nullable().when('type', {\n    is: ChangeRequestType.SCHEDULE,\n    then: (schema) => schema.required('New end date is required for timeline extension')\n  }),\n  newCost: yup.number().nullable().when('type', {\n    is: ChangeRequestType.BUDGET,\n    then: (schema) => schema.required('New cost is required for budget change')\n  }),\n  newManager: yup.string().nullable().when('type', {\n    is: ChangeRequestType.RESOURCE,\n    then: (schema) => schema.required('New project manager is required for delegation')\n  }),\n  newScope: yup.string().nullable().when('type', {\n    is: ChangeRequestType.SCOPE,\n    then: (schema) => schema.required('New scope is required for scope change')\n  })\n});\n\ninterface ChangeRequestDialogProps {\n  open: boolean;\n  onClose: () => void;\n  projectId: string;\n  onSubmitted: () => void;\n  changeRequestType?: string | null;\n}\n\ninterface ChangeRequestFormData {\n  title: string;\n  description: string;\n  type: ChangeRequestType;\n  impact: string;\n  justification: string;\n  alternatives: string;\n  newEndDate: Date | null;\n  newCost: string;\n  newScopeDescription: string;\n  newProjectManagerId: string;\n  closureReason: string;\n  attachments: File[];\n}\n\nconst ChangeRequestDialog: React.FC<ChangeRequestDialogProps> = ({\n  open,\n  onClose,\n  projectId,\n  onSubmitted,\n  changeRequestType = null,\n}) => {\n  const { user } = useAuth();\n  const { users } = useFetchAllUsers();\n  const theme = useTheme();\n  \n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Set initial type based on prop, or default to SCHEDULE\n  const initialType = changeRequestType as ChangeRequestType || ChangeRequestType.SCHEDULE;\n  \n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    type: initialType,\n    newEndDate: null as Date | null,\n    newCost: '',\n    newScopeDescription: '',\n    newProjectManagerId: '',\n    closureReason: '',\n    attachments: [] as File[],\n  });\n\n  // Reset form when dialog opens/closes or type changes\n  useEffect(() => {\n    if (open) {\n      setFormData({\n        title: getDefaultTitle(initialType),\n        description: '',\n        type: initialType,\n        newEndDate: null,\n        newCost: '',\n        newScopeDescription: '',\n        newProjectManagerId: '',\n        closureReason: '',\n        attachments: [],\n      });\n      setError(null);\n    }\n  }, [open, initialType]);\n  \n  // Generate default title based on request type\n  const getDefaultTitle = (type: ChangeRequestType) => {\n    switch (type) {\n      case ChangeRequestType.SCHEDULE:\n        return 'Request to Extend Project Timeline';\n      case ChangeRequestType.BUDGET:\n        return 'Request to Modify Project Budget';\n      case ChangeRequestType.SCOPE:\n        return 'Request to Change Project Scope';\n      case ChangeRequestType.RESOURCE:\n        return 'Request to Change Project Manager';\n      case ChangeRequestType.CLOSURE:\n        return 'Request to Close Project';\n      default:\n        return 'Change Request';\n    }\n  };\n\n  const handleChange = (\n    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement> | SelectChangeEvent\n  ) => {\n    const { name, value } = e.target;\n    setFormData({ ...formData, [name]: value });\n  };\n\n  const handleDateChange = (date: Date | null) => {\n    setFormData({ ...formData, newEndDate: date });\n  };\n\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files) {\n      setFormData({ ...formData, attachments: Array.from(event.target.files) });\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      const validationErrors = await validateForm();\n      if (validationErrors) {\n        setError(validationErrors);\n        setLoading(false);\n        return;\n      }\n\n      // Mock API call\n      await new Promise((resolve) => setTimeout(resolve, 1000));\n      \n      // Create a new request in local data\n      const changeRequest = {\n        id: `cr-${Date.now()}`,\n        projectId,\n        title: formData.title,\n        description: formData.description,\n        type: formData.type,\n        status: 'PENDING',\n        requestedById: user?.id || '',\n        requestedByName: `${user?.firstName} ${user?.lastName}`,\n        requestedDate: new Date().toISOString(),\n        // Add specific fields based on type\n        details: {\n          ...(formData.type === ChangeRequestType.SCHEDULE && { newEndDate: formData.newEndDate }),\n          ...(formData.type === ChangeRequestType.BUDGET && { newCost: formData.newCost }),\n          ...(formData.type === ChangeRequestType.SCOPE && { newScopeDescription: formData.newScopeDescription }),\n          ...(formData.type === ChangeRequestType.RESOURCE && { newProjectManagerId: formData.newProjectManagerId }),\n        },\n        attachments: formData.attachments.map(file => ({ name: file.name, size: file.size })),\n      };\n\n      // Save to localStorage (mock)\n      const existingRequests = JSON.parse(localStorage.getItem('changeRequests') || '[]');\n      localStorage.setItem('changeRequests', JSON.stringify([...existingRequests, changeRequest]));\n\n      // Create audit log entry\n      const auditLogEntry = {\n        id: `audit-${Date.now()}`,\n        projectId,\n        action: 'CHANGE_REQUEST_SUBMITTED',\n        description: getAuditLogDescription(formData.type, formData.title),\n        userId: user?.id || '',\n        userName: `${user?.firstName} ${user?.lastName}`,\n        timestamp: new Date().toISOString(),\n      };\n      const existingLogs = JSON.parse(localStorage.getItem('auditLogs') || '[]');\n      localStorage.setItem('auditLogs', JSON.stringify([...existingLogs, auditLogEntry]));\n\n      onSubmitted();\n      onClose();\n    } catch (err) {\n      setError('Failed to submit change request. Please try again.');\n      console.error('Error submitting change request:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateForm = async () => {\n    try {\n      // Base validation schema\n      let validationSchema = yup.object().shape({\n        title: yup.string().required('Title is required'),\n        description: yup.string().required('Description is required'),\n        type: yup.string().required('Change request type is required'),\n      });\n\n      // Add additional validation based on type\n      switch (formData.type) {\n        case ChangeRequestType.SCHEDULE:\n          validationSchema = validationSchema.shape({\n            newEndDate: yup.date()\n              .nullable()\n              .required('New end date is required')\n              .min(new Date(), 'End date cannot be in the past'),\n          });\n          break;\n        case ChangeRequestType.BUDGET:\n          validationSchema = validationSchema.shape({\n            newCost: yup.number()\n              .required('New cost is required')\n              .min(0, 'Cost must be greater than or equal to 0'),\n          });\n          break;\n        case ChangeRequestType.SCOPE:\n          validationSchema = validationSchema.shape({\n            newScopeDescription: yup.string().required('New scope description is required'),\n          });\n          break;\n        case ChangeRequestType.RESOURCE:\n          validationSchema = validationSchema.shape({\n            newProjectManagerId: yup.string().required('New project manager is required'),\n          });\n          break;\n        case ChangeRequestType.CLOSURE:\n          validationSchema = validationSchema.shape({\n            newEndDate: yup.date()\n              .nullable()\n              .required('Closure date is required')\n              .min(new Date(), 'Closure date cannot be in the past'),\n            closureReason: yup.string().required('Reason for closure is required'),\n          });\n          break;\n      }\n\n      await validationSchema.validate(formData, { abortEarly: false });\n      return null;\n    } catch (err) {\n      if (err instanceof yup.ValidationError) {\n        return err.errors.join(', ');\n      }\n      return 'Validation failed';\n    }\n  };\n\n  const renderAdditionalFields = () => {\n    switch (formData.type) {\n      case ChangeRequestType.SCHEDULE:\n        return (\n          <LocalizationProvider dateAdapter={AdapterDateFns}>\n            <MuiDatePicker\n              label=\"New End Date\"\n              value={formData.newEndDate}\n              onChange={handleDateChange}\n              minDate={new Date()}\n              slotProps={{\n                textField: {\n                  fullWidth: true,\n                  margin: \"normal\",\n                  required: true,\n                  error: !!error && error.includes('date')\n                }\n              }}\n            />\n          </LocalizationProvider>\n        );\n      case ChangeRequestType.BUDGET:\n        return (\n          <TextField\n            name=\"newCost\"\n            label=\"New Budget Cost\"\n            type=\"number\"\n            value={formData.newCost}\n            onChange={handleChange}\n            fullWidth\n            margin=\"normal\"\n            required\n            InputProps={{\n              startAdornment: <InputAdornment position=\"start\">$</InputAdornment>,\n            }}\n            error={!!error && error.includes('cost')}\n          />\n        );\n      case ChangeRequestType.SCOPE:\n        return (\n          <TextField\n            name=\"newScopeDescription\"\n            label=\"New Scope Description\"\n            value={formData.newScopeDescription}\n            onChange={handleChange}\n            fullWidth\n            multiline\n            rows={4}\n            margin=\"normal\"\n            required\n            error={!!error && error.includes('scope')}\n          />\n        );\n      case ChangeRequestType.RESOURCE:\n        return (\n          <FormControl fullWidth margin=\"normal\" required error={!!error && error.includes('manager')}>\n            <InputLabel id=\"new-project-manager-label\">New Project Manager</InputLabel>\n            <Select\n              labelId=\"new-project-manager-label\"\n              id=\"newProjectManagerId\"\n              name=\"newProjectManagerId\"\n              value={formData.newProjectManagerId}\n              onChange={handleChange}\n              label=\"New Project Manager\"\n            >\n              {users\n                .filter(user => user.role === 'PROJECT_MANAGER' || user.role === 'MAIN_PMO')\n                .map((user) => (\n                  <MenuItem key={user.id} value={user.id}>\n                    {user.firstName} {user.lastName} ({user.role})\n                  </MenuItem>\n                ))}\n            </Select>\n          </FormControl>\n        );\n      case ChangeRequestType.CLOSURE:\n        return (\n          <>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <MuiDatePicker\n                label=\"Requested Closure Date\"\n                value={formData.newEndDate}\n                onChange={handleDateChange}\n                minDate={new Date()}\n                slotProps={{\n                  textField: {\n                    fullWidth: true,\n                    margin: \"normal\",\n                    required: true,\n                    error: !!error && error.includes('date')\n                  }\n                }}\n              />\n            </LocalizationProvider>\n            <TextField\n              name=\"closureReason\"\n              label=\"Reason for Closure\"\n              value={formData.closureReason || ''}\n              onChange={handleChange}\n              fullWidth\n              multiline\n              rows={3}\n              margin=\"normal\"\n              required\n              error={!!error && error.includes('reason')}\n            />\n          </>\n        );\n      default:\n        return null;\n    }\n  };\n\n  // Helper to get descriptive audit log message\n  const getAuditLogDescription = (type: ChangeRequestType, title: string): string => {\n    switch (type) {\n      case ChangeRequestType.SCHEDULE:\n        return `Submitted a schedule extension request: ${title}`;\n      case ChangeRequestType.BUDGET:\n        return `Submitted a budget change request: ${title}`;\n      case ChangeRequestType.SCOPE:\n        return `Submitted a scope change request: ${title}`;\n      case ChangeRequestType.RESOURCE:\n        return `Submitted a project delegation request: ${title}`;\n      case ChangeRequestType.CLOSURE:\n        return `Submitted a project closure request: ${title}`;\n      default:\n        return `Submitted a change request: ${title}`;\n    }\n  };\n\n  return (\n    <Dialog open={open} onClose={onClose} maxWidth=\"md\" fullWidth>\n      <DialogTitle>\n        Submit Change Request\n        {formData.type && (\n          <Typography variant=\"caption\" display=\"block\" color=\"textSecondary\">\n            Type: {formData.type.replace('_', ' ')}\n          </Typography>\n        )}\n      </DialogTitle>\n      <DialogContent>\n        {error && (\n          <Alert severity=\"error\" sx={{ mb: 2 }}>\n            {error}\n          </Alert>\n        )}\n        <form onSubmit={handleSubmit} id=\"change-request-form\">\n          <TextField\n            name=\"title\"\n            label=\"Title\"\n            value={formData.title}\n            onChange={handleChange}\n            fullWidth\n            margin=\"normal\"\n            required\n            error={!!error && error.includes('Title')}\n          />\n          \n          <FormControl fullWidth margin=\"normal\">\n            <InputLabel id=\"change-request-type-label\">Change Request Type</InputLabel>\n            <Select\n              labelId=\"change-request-type-label\"\n              id=\"type\"\n              name=\"type\"\n              value={formData.type}\n              onChange={handleChange}\n              label=\"Change Request Type\"\n            >\n              <MenuItem value={ChangeRequestType.SCHEDULE}>Extend Project</MenuItem>\n              <MenuItem value={ChangeRequestType.BUDGET}>Change Project Cost</MenuItem>\n              <MenuItem value={ChangeRequestType.SCOPE}>Change Project Scope</MenuItem>\n              <MenuItem value={ChangeRequestType.RESOURCE}>Delegate Project</MenuItem>\n              <MenuItem value={ChangeRequestType.CLOSURE}>Close Project</MenuItem>\n              <MenuItem value={ChangeRequestType.OTHER}>Other Change</MenuItem>\n            </Select>\n          </FormControl>\n          \n          <TextField\n            name=\"description\"\n            label=\"Description\"\n            value={formData.description}\n            onChange={handleChange}\n            fullWidth\n            multiline\n            rows={3}\n            margin=\"normal\"\n            required\n            error={!!error && error.includes('Description')}\n          />\n          \n          {renderAdditionalFields()}\n          \n          <Box sx={{ mt: 2 }}>\n            <Button\n              variant=\"contained\"\n              component=\"label\"\n              startIcon={<AttachFileIcon />}\n              sx={{ mr: 1 }}\n            >\n              Attach Files\n              <input type=\"file\" hidden multiple onChange={handleFileChange} />\n            </Button>\n            {formData.attachments.length > 0 && (\n              <Typography variant=\"body2\" color=\"textSecondary\">\n                {formData.attachments.length} file(s) selected\n              </Typography>\n            )}\n          </Box>\n          \n          {formData.attachments.length > 0 && (\n            <List dense sx={{ mt: 1 }}>\n              {formData.attachments.map((file, index) => (\n                <ListItem key={index}>\n                  <ListItemIcon>\n                    <InsertDriveFileIcon />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={file.name}\n                    secondary={`${(file.size / 1024).toFixed(2)} KB`}\n                  />\n                </ListItem>\n              ))}\n            </List>\n          )}\n        </form>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} disabled={loading}>\n          Cancel\n        </Button>\n        <Button\n          type=\"submit\"\n          form=\"change-request-form\"\n          variant=\"contained\"\n          color=\"primary\"\n          disabled={loading}\n          startIcon={loading && <CircularProgress size={20} />}\n        >\n          Submit Request\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ChangeRequestDialog; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}